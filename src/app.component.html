<div class="min-h-screen bg-[#0a0a1a] text-cyan-300 p-4 sm:p-6 lg:p-8 flex items-center justify-center">
  <div class="w-full max-w-7xl mx-auto border-2 border-fuchsia-500/50 bg-black/30 backdrop-blur-sm p-4 sm:p-6 rounded-lg shadow-[0_0_25px_rgba(217,70,239,0.4)]">
    
    <!-- Header -->
    <header class="flex justify-between items-center border-b-2 border-cyan-400/30 pb-4 mb-6">
      <h1 class="font-orbitron text-2xl sm:text-4xl font-bold text-cyan-400 tracking-widest">
        CYBER<span class="text-fuchsia-500">ASIO</span> CORE
      </h1>
      <div class="flex items-center space-x-4">
        <span class="font-orbitron text-sm hidden sm:inline">v1.2.0</span>
        <div class="flex items-center space-x-2">
          <div [class]="'w-3 h-3 rounded-full ' + (driverStatus() === 'ONLINE' ? 'bg-green-400 animate-pulse' : 'bg-red-500')"
               [class.shadow-[0_0_8px_rgba(74,222,128,0.8)]]="driverStatus() === 'ONLINE'"
               [class.shadow-[0_0_8px_rgba(239,68,68,0.8)]]="driverStatus() !== 'ONLINE'">
          </div>
          <span class="font-semibold text-sm" [class.text-green-400]="driverStatus() === 'ONLINE'" [class.text-red-500]="driverStatus() !== 'ONLINE'">
            {{ driverStatus() }}
          </span>
        </div>
      </div>
    </header>

    <!-- Main Content Grid -->
    <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- Left Column: Devices & Settings -->
      <div class="lg:col-span-1 space-y-6">
        <!-- Sound Devices Panel -->
        <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded">
          <h2 class="font-orbitron text-lg text-fuchsia-400 mb-4 tracking-wider">SOUND DEVICES</h2>
          <ul class="space-y-2 max-h-48 overflow-y-auto">
            @for (device of devices(); track device.id) {
              <li (click)="device.status !== 'Disabled' && selectDevice(device.id)"
                  class="flex justify-between items-center p-2 rounded transition-all duration-200"
                  [class]="selectedDeviceId() === device.id ? 'bg-cyan-500/20 border-l-4 border-cyan-400 cursor-pointer' : 'hover:bg-gray-700/50 cursor-pointer'"
                  [class.opacity-50]="device.status === 'Disabled'"
                  [class.cursor-not-allowed]="device.status === 'Disabled'">
                <div>
                  <p class="font-semibold">{{ device.name }}</p>
                  <p class="text-xs text-gray-400">{{ device.type }}</p>
                </div>
                <div class="text-right">
                    @if (device.status === 'Active') {
                      <span class="text-xs font-bold text-green-400">ACTIVE</span>
                    } @else if (device.status === 'Inactive') {
                      <span class="text-xs text-gray-500">INACTIVE</span>
                    } @else {
                      <span class="text-xs text-red-500">DISABLED</span>
                    }
                </div>
              </li>
            }
          </ul>
        </div>
        
        <!-- ASIO Settings -->
        <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded">
          <h2 class="font-orbitron text-lg text-fuchsia-400 mb-4 tracking-wider">CORE SETTINGS</h2>
          <div class="space-y-4">
            <!-- Sample Rate -->
            <div>
              <label class="text-sm text-cyan-300">Sample Rate</label>
              <div class="flex space-x-2 mt-1">
                @for (rate of sampleRates; track rate) {
                  <button (click)="setSampleRate(rate)"
                          class="flex-1 text-xs px-2 py-1 rounded transition-colors"
                          [class]="selectedSampleRate() === rate ? 'bg-fuchsia-600 text-white shadow-[0_0_10px_rgba(192,38,211,0.7)]' : 'bg-gray-800 hover:bg-gray-700'">
                    {{ getSampleRateLabel(rate) }}
                  </button>
                }
              </div>
            </div>
            <!-- Buffer Size -->
            <div>
              <label for="buffer-size" class="text-sm text-cyan-300 flex justify-between">
                <span>Buffer Size</span>
                <span class="font-bold text-fuchsia-400">{{ getBufferSizeLabel(selectedBufferSize()) }}</span>
              </label>
              <input id="buffer-size" type="range" 
                     [min]="bufferSizes[0]" [max]="bufferSizes[bufferSizes.length - 1]" 
                     [step]="bufferSizes[0]"
                     [value]="selectedBufferSize()" 
                     (input)="setBufferSize(+$event.target.value)"
                     class="w-full mt-2">
            </div>
             <!-- Bit Depth -->
            <div>
              <label class="text-sm text-cyan-300">Bit Depth</label>
              <div class="grid grid-cols-3 gap-2 mt-1">
                @for (depth of bitDepths; track depth) {
                  <button (click)="setBitDepth(depth)"
                          class="px-2 py-1 rounded transition-colors text-xs"
                          [class]="selectedBitDepth() === depth ? 'bg-fuchsia-600 text-white shadow-[0_0_10px_rgba(192,38,211,0.7)]' : 'bg-gray-800 hover:bg-gray-700'">
                    {{ depth }}-bit
                  </button>
                }
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Status & Visualizer -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Status Display -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded text-center">
            <p class="text-sm text-gray-400 font-orbitron">LATENCY</p>
            <p class="text-4xl font-bold text-cyan-400">{{ latency() }}<span class="text-xl"> ms</span></p>
          </div>
          <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded text-center">
            <p class="text-sm text-gray-400 font-orbitron">SAMPLE RATE</p>
            <p class="text-4xl font-bold text-cyan-400">{{ (selectedSampleRate() / 1000) }}<span class="text-xl"> kHz</span></p>
          </div>
          <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded text-center">
            <p class="text-sm text-gray-400 font-orbitron">BUFFER</p>
            <p class="text-4xl font-bold text-cyan-400">{{ selectedBufferSize() }}</p>
          </div>
           <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded text-center">
            <p class="text-sm text-gray-400 font-orbitron">BIT DEPTH</p>
            <p class="text-4xl font-bold text-cyan-400">{{ selectedBitDepth() }}<span class="text-xl">-bit</span></p>
          </div>
        </div>
        
        <!-- Visualizer and Player -->
        <div class="bg-gray-900/50 border border-cyan-400/30 p-4 rounded">
          <h2 class="font-orbitron text-lg text-fuchsia-400 mb-2 tracking-wider">SYSTEM PLAYBACK TEST</h2>
          <p class="text-center text-xs text-gray-400 truncate" title="{{ currentFileName() }}">
            NOW PLAYING: {{ currentFileName() }}
          </p>
          <!-- Visualization Mode Selector -->
          <div class="flex justify-center gap-2 my-4">
            <button (click)="setVisualizationType('BARS')" class="text-xs px-3 py-1 rounded transition-colors" [class]="visualizationType() === 'BARS' ? 'bg-fuchsia-600 text-white shadow-[0_0_10px_rgba(192,38,211,0.7)]' : 'bg-gray-800 hover:bg-gray-700'">Bars</button>
            <button (click)="setVisualizationType('SPECTROGRAM')" class="text-xs px-3 py-1 rounded transition-colors" [class]="visualizationType() === 'SPECTROGRAM' ? 'bg-fuchsia-600 text-white shadow-[0_0_10px_rgba(192,38,211,0.7)]' : 'bg-gray-800 hover:bg-gray-700'">Spectrogram</button>
            <button (click)="setVisualizationType('WAVEFORM')" class="text-xs px-3 py-1 rounded transition-colors" [class]="visualizationType() === 'WAVEFORM' ? 'bg-fuchsia-600 text-white shadow-[0_0_10px_rgba(192,38,211,0.7)]' : 'bg-gray-800 hover:bg-gray-700'">Waveform</button>
          </div>

          <!-- Visualizer -->
          <div class="w-full h-40 bg-gradient-to-b from-fuchsia-900/30 to-cyan-900/10 p-2 rounded border border-gray-700 overflow-hidden">
            @switch (visualizationType()) {
              @case ('BARS') {
                <canvas #barsCanvas class="w-full h-full rounded"></canvas>
              }
              @case ('SPECTROGRAM') {
                <canvas #spectrogramCanvas class="w-full h-full rounded"></canvas>
              }
              @case ('WAVEFORM') {
                <canvas #waveformCanvas class="w-full h-full rounded"></canvas>
              }
            }
          </div>

          <!-- Player Controls -->
          <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
            <input type="file" id="audio-upload" class="hidden" (change)="onFileSelected($event)" accept="audio/*">
            <label for="audio-upload" class="font-orbitron text-lg px-6 py-2 rounded border-2 transition-all duration-300 flex items-center space-x-3 cursor-pointer border-cyan-400 text-cyan-400 hover:bg-cyan-400/20 hover:shadow-[0_0_15px_rgba(34,211,238,0.5)]">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
              </svg>
              <span>LOAD FILE</span>
            </label>

             <button (click)="togglePlayback()" class="font-orbitron text-xl px-8 py-3 rounded border-2 transition-all duration-300 flex items-center space-x-3"
              [class]="isPlaying() ? 'bg-fuchsia-500/20 border-fuchsia-500 text-fuchsia-400 shadow-[0_0_15px_rgba(217,70,239,0.5)]' : 'border-cyan-400 text-cyan-400 hover:bg-cyan-400/20 hover:shadow-[0_0_15px_rgba(34,211,238,0.5)]'">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                @if (!isPlaying()) {
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                } @else {
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                }
              </svg>
              <span>{{ isPlaying() ? 'PAUSE' : 'PLAY' }}</span>
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>